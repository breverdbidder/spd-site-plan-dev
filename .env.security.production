# SPD.AI Production Security Configuration
# P5 Security: Production security config (+1 point)
#
# IMPORTANT: Copy this file to .env.security and fill in actual values
# NEVER commit actual secrets to version control
#
# Author: BidDeed.AI / Everest Capital USA

# =============================================================================
# SECURITY LEVEL
# =============================================================================

# Overall security level: STANDARD, HIGH, MAXIMUM
SECURITY_LEVEL=MAXIMUM

# Feature toggles
ENCRYPTION_ENABLED=true
THREAT_DETECTION_ENABLED=true
RATE_LIMIT_ENABLED=true
ANOMALY_DETECTION_ENABLED=true
AUDIT_LOG_ENABLED=true

# =============================================================================
# ENCRYPTION SETTINGS
# =============================================================================

# Master encryption key (32 characters minimum, use secrets manager in production)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
ENCRYPTION_MASTER_KEY=your-32-character-encryption-key-here

# Encryption algorithm
ENCRYPTION_ALGORITHM=AES-256-GCM

# Key rotation interval (days)
KEY_ROTATION_INTERVAL_DAYS=90

# =============================================================================
# THREAT DETECTION
# =============================================================================

# Auto-block critical threats
AUTO_BLOCK_CRITICAL=true

# Rate limit settings
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BLOCK_DURATION_MINUTES=10

# Anomaly detection sensitivity (LOW, MEDIUM, HIGH)
ANOMALY_SENSITIVITY=HIGH

# Input size limits
MAX_INPUT_LENGTH=50000
MAX_REQUEST_SIZE_MB=10

# =============================================================================
# ALERTING
# =============================================================================

# Slack webhook for security alerts
SLACK_SECURITY_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Email for critical alerts
SECURITY_EMAIL=security@biddeed.ai

# Alert deduplication window (seconds)
ALERT_DEDUP_WINDOW_SECONDS=300

# Severity routing (comma-separated channels per severity)
# Channels: console, supabase, slack, email, pagerduty
ALERT_ROUTING_INFO=console,supabase
ALERT_ROUTING_WARNING=console,supabase,slack
ALERT_ROUTING_HIGH=console,supabase,slack
ALERT_ROUTING_CRITICAL=console,supabase,slack,email

# =============================================================================
# AUDIT LOGGING
# =============================================================================

# Audit log level: MINIMAL, STANDARD, FULL
AUDIT_LOG_LEVEL=FULL

# Audit log retention (days)
AUDIT_LOG_RETENTION_DAYS=365

# Log sensitive data (redacted)
LOG_SENSITIVE_DATA=false

# =============================================================================
# SERVICE ACCOUNTS
# =============================================================================

# Supabase service accounts (use different keys for each agent)
# These should be set via GitHub Secrets or Vault in production

# Scraper agent - read-only access to parcels
# SPD_SCRAPER_KEY=your-scraper-service-key

# Analysis agent - read/write for analysis
# SPD_ANALYSIS_KEY=your-analysis-service-key

# Report agent - read/write for reports
# SPD_REPORT_KEY=your-report-service-key

# QA agent - read-only verification
# SPD_QA_KEY=your-qa-service-key

# =============================================================================
# ROW LEVEL SECURITY
# =============================================================================

# RLS enforcement mode
RLS_ENFORCEMENT=STRICT

# Default deny policy
RLS_DEFAULT_DENY=true

# Bypass for admin (use cautiously)
RLS_ADMIN_BYPASS=false

# =============================================================================
# SESSION SECURITY
# =============================================================================

# Session timeout (minutes)
SESSION_TIMEOUT_MINUTES=30

# Max concurrent sessions per user
MAX_CONCURRENT_SESSIONS=3

# Require re-authentication for sensitive operations
REQUIRE_REAUTH_SENSITIVE=true

# =============================================================================
# API SECURITY
# =============================================================================

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://app.biddeed.ai,https://api.biddeed.ai

# API rate limiting
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_WINDOW_MS=60000
API_RATE_LIMIT_MAX_REQUESTS=100

# Request validation
VALIDATE_REQUEST_SIGNATURES=true
REQUIRE_HTTPS=true

# =============================================================================
# MONITORING
# =============================================================================

# Security dashboard update interval (seconds)
DASHBOARD_UPDATE_INTERVAL=300

# Weekly report schedule (cron format)
WEEKLY_REPORT_SCHEDULE=0 9 * * MON

# Health check interval (seconds)
HEALTH_CHECK_INTERVAL=60

# Metrics retention (days)
METRICS_RETENTION_DAYS=90

# =============================================================================
# INCIDENT RESPONSE
# =============================================================================

# Auto-quarantine on critical threat
AUTO_QUARANTINE_ENABLED=true

# Incident notification list (comma-separated emails)
INCIDENT_NOTIFY_LIST=security@biddeed.ai,cto@biddeed.ai

# Emergency shutdown enabled
EMERGENCY_SHUTDOWN_ENABLED=true

# =============================================================================
# COMPLIANCE
# =============================================================================

# Compliance frameworks (comma-separated)
COMPLIANCE_FRAMEWORKS=SOC2,ISO27001,OWASP,NIST

# Data residency region
DATA_RESIDENCY=US

# PII handling mode
PII_HANDLING=ENCRYPTED

# GDPR compliance
GDPR_ENABLED=true

# =============================================================================
# DEVELOPMENT OVERRIDES (DO NOT USE IN PRODUCTION)
# =============================================================================

# Set these to false/disabled in production
# DEV_MODE=false
# SKIP_AUTH=false
# DISABLE_RLS=false
# MOCK_EXTERNAL_APIS=false
